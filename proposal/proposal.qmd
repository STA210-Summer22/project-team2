---
title: "Proposal"
subtitle: "STA 210 - Project"
author: "Team 2 - Alicia Gong, Ashley Chen, Abdel Shehata, Claire Tan"
format: pdf
editor: visual
---

```{r}
#| label: load-pkg-data
#| warning: false
library(tidyverse)
library(tidymodels)
library(dplyr)
library(ggplot2)
library(cowplot)


redwine <- read.csv("winequality-red.csv", sep = ";")
whitewine <- read.csv("winequality-white.csv", sep = ";")
redwine<-redwine%>%mutate(color="red")
whitewine<-whitewine%>%mutate(color="white")
wine<-redwine%>%full_join(whitewine)

```

## Introduction

Project Goal: To identify variables that are important in explaining variation in the response.

We are interested in what factors contribute to the quality of Portuguese "Vinho Verde" red wine. The goal of this dataset is to model wine quality based on physicochemical tests. We believe that this dataset can also be used to analyze the relationship between different chemical compositions and the ratings of red wine quality. We believe this is important because by understanding what chemical compositions affect red wine qualities, it may shed some light in future direction of improving/preserving red wine quality.

Out goal is to produce a regression model that best explains how different chemical compositions of the Portuguese "Vinho Verde" red wine affects the variation of the red wine quality.

## Data description

```{r}
wine<- slice(wine, sample(1:n()))
glimpse(wine)
```

There are 6497 observations and 13 variables.

```{r}
summary(wine)
```

```{r}
p1  <- ggplot(data = wine, aes(x = quality) ) + 
  geom_histogram(fill = "pink") 

p2  <- ggplot(data = wine, aes(x = fixed.acidity) ) + 
  geom_histogram(fill = "pink") 

p3  <- ggplot(data = wine, aes(x = volatile.acidity) ) + 
  theme(axis.text=element_text(size=9)) + 
  geom_histogram(fill = "pink") 

p4  <- ggplot(data = wine, aes(x = citric.acid) ) + 
  theme(axis.text = element_text(size=9)) + 
  geom_histogram(fill = "pink") 

p5  <- ggplot(data = wine, aes(x = residual.sugar) ) +
  geom_histogram(fill = "pink")

p6  <- ggplot(data = wine, aes(x = chlorides) ) + 
  theme(axis.text = element_text(size = 11)) + 
  geom_histogram(fill = "pink") 

p7  <- ggplot(data = wine, aes(x = free.sulfur.dioxide) ) + 
  theme(axis.text = element_text(size=9)) + 
  geom_histogram(fill = "pink") 

p8  <- ggplot(data = wine, aes(x = total.sulfur.dioxide) ) + 
  theme(axis.text = element_text(size=9)) + 
  geom_histogram(fill = "pink")

p9  <- ggplot(data = wine, aes(x = density) ) + 
  theme(axis.text = element_text(size = 7.5)) + 
  geom_histogram(fill= "pink")

p10 <- ggplot(data = wine, aes(x = pH) ) + 
  geom_histogram(fill = "pink")

p11 <- ggplot(data = wine, aes(x = sulphates) ) + 
  theme(axis.text = element_text(size=9)) + 
  geom_histogram(fill= "pink")

p12 <- ggplot(data = wine, aes(x = alcohol) ) + 
  geom_histogram(fill= "pink")

plot_grid(p1, p2, p3, p4, p5, p6, p7, p8, p9, p10, p11, p12, ncol = 4, nrow = 3)
```

Most of the variables are normally distributed. Variables like fixed.acidity, volatile.acidity, citric.acid, residual sugar, free.sulfur.dioxide, total.sulfur.dioxide, sulphates, and alcohol are right-skewed.

```{r}
d1 <- ggplot(wine, aes(x = fixed.acidity, color = as.factor(quality))) + 
  geom_density() 

d2 <- ggplot(wine, aes(x = volatile.acidity, color = as.factor(quality))) + 
  geom_density() 

d3 <- ggplot(wine, aes(x = citric.acid, color = as.factor(quality))) + 
  geom_density()

plot_grid(d1, d2, d3, ncol = 1, nrow = 3)
```

Wine with quality points of 9 has the highest peak of density of fixed.acidity at approximate 7 g/dm\^3; wine with quality points of 9 has the highest peak of density of volatile.acidity at approximate 0.3 g/dm\^3; red wine with quality points of 9 has the highest peak of density of citric.acid at approximate 0.03 g/dm\^3.

```{r}
d4 <- ggplot(wine, aes(x = residual.sugar, color = as.factor(quality))) + 
  geom_density()

d5 <- ggplot(wine, aes(x = chlorides, color = as.factor(quality))) + 
  geom_density()

d6 <- ggplot(wine, aes(x = free.sulfur.dioxide, color = as.factor(quality))) + 
  geom_density()


plot_grid(d4, d5, d6, ncol = 1, nrow = 3)
```

wine with quality points of 9 has the highest peak of density of chlorides at approximate 0.07 g/dm\^3.

```{r}
d7 <- ggplot(wine, aes(x = sulphates, color = as.factor(quality))) + 
  geom_density()

d8 <- ggplot(wine, aes(x = alcohol, color = as.factor(quality))) + 
  geom_density()

d9 <- ggplot(wine, aes(x = pH, color = as.factor(quality))) + 
  geom_density()


plot_grid(d7, d8, d9, ncol = 1, nrow = 3)
```

Red wine with quality points of 9 has the highest peak of density of alcohol at approximate 13 vol.

```{r}
d10 <- ggplot(wine, aes(x = total.sulfur.dioxide, color = as.factor(quality))) + 
  geom_density()

d11 <- ggplot(wine, aes(x = density, color = as.factor(quality))) + 
  geom_density()


plot_grid(d10, d11, ncol = 1, nrow = 2)
```

Red wine with quality points of 9 has the highest peak of density of the density of the liquid at approximate 0.99 g/cm\^3.

## Analysis approach

First, we will make visualizations and calculate summary statistics as part of exploratory data analysis. This will give us a better idea of which predictor variables we should focus on. After visualizing the relationships between our quality (the outcome variable) and the other predictor variables, alcohol and density seem to be the strongest predictors for quality of wine. We will also explore the relationship between chemical composition of wine and color of wine.

Since quality is a categorical variable that can take the values 3-9, we will conduct multinomial logistic regression and fit two multiLR models for predicting quality: the first is a reduced model with only alcohol and density as predictors, and the second is a full model. Similarly, since color is a binary variable, we will fit two LR models for predicting color, one reduced and one full. These models will be compared using adjusted R-squared, AIC, and BIC. Then, we will check the conditions for inference. For linearity, we will examine empirical logit plots between each level of the response and the quantitative predictor variables. We will check randomness and independence based on the context of the data and how the observations were collected.

For prediction, we will build two models for each outcome variable based on our previous evaluations of the relationship between the predictor and response variables, then conduct CV and evaluate which model is preferred. We will then fit the models to the testing data and again evaluate the performance of these models using a confusion matrix and ROC curves. Lastly, we will make predictions for some example observations.

## Data dictionary

The data dictionary can be found [here](ADD%20LINK!!!).
